<div class="card-list-header">

</div>
<div #container class="card-item-container column gap-2"
    cdkDropList (cdkDropListDropped)="onDrop($event)">
    @for (itemCard of itemCards(); track getId()(itemCard.item)) {
        <div #card cdkDrag class="{{cardClasses()}} card-item selectable-card"
            [class.hidden]="itemCard.height() === 0"
            [style.height]="itemCard.height() !== null ? itemCard.height() + 'px' : 'auto'"
            (click)="onItemClick(itemCard)">
            @if (reorderable()) {
                <div class="drag-handle">
                    <app-icon icon="re_order_dots_vertical"/>
                </div>
            }
            <ng-container *ngTemplateOutlet="itemTemplate();
                context: { $implicit: itemCard.item }"/>
        </div>
    }
    @if (editable()) {
        <div class="{{cardClasses()}} card-item selectable-card"
            (click)="onInsertClick()">
            <app-swap-container [swap]="inserting()" animationDuration="xs">
                <div main class="row items-center">
                    @if (insertedItem(); as insert) {
                        @if (reorderable()) {
                            <div class="drag-handle">
                                <app-icon icon="re_order_dots_vertical"/>
                            </div>
                        }
                        <ng-container *ngTemplateOutlet="itemTemplate();
                            context: { $implicit: insert }"/>
                    } @else {
                        <div class="full-width items-center center-content">
                            <app-icon class="m-3" icon="add"/>
                        </div>
                    }
                </div>
                <div swapped #insertion class="insertion grow-1 p-3">
                    @if (insertTemplate(); as template) {
                        <ng-container *ngTemplateOutlet="template;
                            context: { $implicit: insert }"/>
                    }
                </div>
            </app-swap-container>
        </div>
    }
</div>